# ClipMash

[Discord](https://discord.gg/qRbDqtqmrX) - [Ko-Fi](https://ko-fi.com/soundchaser128)

ClipMash is a video editing app that allows you to automate creating compilations from multiple videos. It runs in your browser.
It's mostly made for, ahem, adult content, which is why it can connect to [Stash](https://stashapp.cc/) and fetch videos
and scene markers from there to guide the video creation process. You can also use local files and set the markers in 
ClipMash itself and then generate a compilation based on that.

## Features
- Can use videos from your hard drive by specifying a folder path.
- Allows using videos from Stash, if you have it.
- Allows adding markers to videos inside the app (specifying the parts of the video that you want included in your compilation)
- Supports adding music to videos, either replacing the entire audio track or mixing it in at a specified volume.
- When using music, clips can optionally be created based on the song's beats, i.e. cuts will happen to the beat of the music.
- Can generate `.funscript` files automatically by stitching together the scripts for the individual videos (if a .funscript file exists in the same folder with the same name, e.g. `cool-video.mp4` and `cool-video.funscript`).
- Videos are generated by splicing together clips from the selected markers. The clips are short segments of the individual markers with a randomized, user-specified length. 

## Usage
Download the binary for your OS from the releases page and run it. A new browser tab should open with the GUI. 

The app requires `ffmpeg` to run, and will attempt to download it, if it isn't installed on your machine.
This currently only works for Windows and Linux systems, Mac users will have to install it either by 
downloading the executable and placing it into their `$PATH` or installing it with `brew install ffmpeg`.

## Docker
To run the app in Docker, try the following:
```sh
docker run -p 5174:5174 --mount type=bind,source=<ENTER-DATA_DIRECTORY_HERE>,destination=/app/data ghcr.io/soundchaser128/clip-mash:latest
```


## Troubleshooting
### ClipMash doesn't start, it only shows a console window for a fraction of a second and nothing else happens
This seems to happen sometimes on Windows when ClipMash can't download the ffmpeg and ffprobe executables. You can solve it 
by downloading the ffmpeg executables from [here](https://ffmpeg.org/download.html) and placing them next to `clip-mash.exe`.

## Building
Requires `cargo`, `rustc` (see http://rustup.rs/) and `node` and `npm` (see https://nodejs.org/en). When those
tools are installed, you should be able to build:

## Building for development

```shell
# Required to create the database and apply the schema
cargo install sqlx-cli
sqlx migrate run

cd frontend
npm install
npm run dev

# In a new shell, in the project root:
cargo run
```

## Building for production
```shell
cd frontend
npm install
npm run build

cd ..
# Required to create the database and apply the schema
cargo install sqlx-cli
sqlx migrate run
cargo build --release
```
